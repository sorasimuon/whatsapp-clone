(this["webpackJsonpwhatsapp-clone"]=this["webpackJsonpwhatsapp-clone"]||[]).push([[0],{113:function(e,t,a){e.exports={newContact:"NewContact_newContact__3dNVM"}},131:function(e,t,a){},150:function(e,t,a){},151:function(e,t,a){},156:function(e,t,a){},159:function(e,t,a){},160:function(e,t,a){},161:function(e,t,a){},237:function(e,t,a){},238:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);var n=a(2),s=a(0),c=a.n(s),r=a(11),i=a.n(r),o=(a(131),a(13)),l=a.n(o),u=a(34),d=a(18),b=a(8),j=Object(s.createContext)(),m=function(e){var t=e.reducer,a=e.initialState,c=e.children;return Object(n.jsx)(j.Provider,{value:Object(s.useReducer)(t,a),children:c})},h=function(){return Object(s.useContext)(j)},O=a(25),v=a.n(O),_=(a(79),a(101)),p=a.n(_).a.create({baseURL:"https://whatsapp-bck.herokuapp.com/"}),f=a(14),g=(a(150),a(267)),x=a(270),N=a(278),C=a(272),S=a(44),w=a.n(S),E=a(65),y=a.n(E),T=(a(151),a(105)),I=a.n(T),R=a(106),L=a.n(R),k=a(107),A=a.n(k),D=a(279),B=a(68),F=a(108),P=a.n(F),W=Object(g.a)((function(e){return{iconButton:{fontSize:30,fontWeight:200,color:B.a[600]},inputInput:{backgroundColor:"rgba(255,255,255,0.5)",borderRadius:"20px",color:"rgb(100,100,100)",width:"100%",height:40}}}));var U=function(){var e=h(),t=Object(b.a)(e,2),a=t[0],c=a.user,r=a.currentConversation,i=(t[1],Object(s.useState)("")),o=Object(b.a)(i,2),u=o[0],j=o[1],m=W(),O=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a={message:u,firstname:c.firstname,email:c.email},j(""),e.next=5,p.post("/messages/new-message",{newMessage:a,currentConversation:r}).then((function(e){console.log("Sent new message from ".concat(e.data.firstname," at ").concat(new Date(e.data.timestamp).toLocaleTimeString()," >> ").concat(e.data.message))}));case 5:e.sent;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{className:"typingbar",children:[Object(n.jsx)(x.a,{children:Object(n.jsx)(I.a,{className:m.iconButton})}),Object(n.jsx)(x.a,{children:Object(n.jsx)(L.a,{className:m.iconButton})}),Object(n.jsx)("div",{className:"typing-search",children:Object(n.jsx)("form",{onSubmit:function(e){return O(e)},children:Object(n.jsx)(D.a,{placeholder:"Type text",className:m.inputInput,inputProps:{"aria-label":"search"},onChange:function(e){return j(e.target.value)},value:u})})}),Object(n.jsx)(x.a,{children:u?Object(n.jsx)(A.a,{className:m.iconButton}):Object(n.jsx)(P.a,{className:m.iconButton})})]})};a(156);var V=function(e){e.messageName;var t=e.messageContent,a=e.messageTimestamp,s=e.messageReceiver,c=void 0!==s&&s;return Object(n.jsxs)("div",{className:"message ".concat(c?"message-receiver":""),children:[Object(n.jsx)("span",{className:"message-content",children:t}),Object(n.jsx)("span",{className:"message-timestamp",children:a})]})},q=a(277),M=Object(g.a)((function(e){return{avatar:{color:e.palette.getContrastText(C.a[500]),backgroundColor:C.a[300],height:"40px",width:"40px",marginRight:20}}}));var z=function(){var e,t,a,c,r=M(),i=h(),o=Object(b.a)(i,2),j=o[0],m=j.user,O=j.currentConversation,_=j.contacts,p=j.conversations,g=(o[1],Object(f.f)()),C=function(){var e="",t=null;try{v()(O)&&!v()(p)?t=p[0]:v()(O)?g.replace("/whatsapp-clone/login"):t=O;var a,n=Object(u.a)(t.chatters);try{for(n.s();!(a=n.n()).done;){var s=a.value;s!==m.email&&(e=s)}}catch(l){n.e(l)}finally{n.f()}var c,r={},i=Object(u.a)(_);try{for(i.s();!(c=i.n()).done;){var o=c.value;o.email===e&&(r.firstname=o.firstname,r.lastname=o.lastname,r.email=o.email)}}catch(l){i.e(l)}finally{i.f()}return r}catch(d){g.replace("/whatsapp-clone/login")}},S=Object(s.useState)(null===(e=C())||void 0===e?void 0:e.firstname),E=Object(b.a)(S,2),T=E[0],I=E[1],R=Object(s.useState)(null===(t=C())||void 0===t?void 0:t.lastname),L=Object(b.a)(R,2),k=L[0],A=L[1],D=Object(s.useState)(null===(a=C())||void 0===a?void 0:a.email),B=Object(b.a)(D,2),F=(B[0],B[1]),P=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v()(O)?console.log("marche pas "):(I(C().firstname),A(C().lastname),F(C().email));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){P()}),[O]),Object(n.jsxs)("div",{className:"chat",children:[Object(n.jsxs)("div",{className:"chatbar-navbar",children:[Object(n.jsxs)("div",{className:"chatbar-left",children:[Object(n.jsx)(N.a,{className:r.avatar,children:null===T||void 0===T?void 0:T.charAt(0)}),Object(n.jsxs)("div",{className:"chatbar-title",children:[Object(n.jsxs)("label",{className:"chatbar-name",children:[T," ",k]}),Object(n.jsx)("label",{className:"chatbar-status",children:"Online"})]})]}),Object(n.jsxs)("div",{className:"chatbar-right",children:[Object(n.jsx)(x.a,{children:Object(n.jsx)(w.a,{})}),Object(n.jsx)(x.a,{children:Object(n.jsx)(y.a,{})})]})]}),Object(n.jsx)("div",{className:"chat-body",children:v()(O.messages)?"":null===(c=O.messages)||void 0===c?void 0:c.map((function(e){return Object(n.jsx)("div",{children:Object(n.jsx)(V,{messageName:e.firstname,messageContent:e.message,messageTimestamp:new Date(e.timestamp).toLocaleTimeString(),messageReceiver:m.email===e.email},Object(q.a)())},Object(q.a)())}))}),Object(n.jsx)(U,{})]})},G=a(28),K=a.n(G),J=a(109),Q=a.n(J),H=a(110),X=a.n(H),Y=a(111),Z=a.n(Y),$=(a(159),a(273)),ee=Object(g.a)((function(e){return{avatar:{height:"60px",width:"60px",backgroundColor:C.a[300]}}}));var te=function(e){var t,a=e.conversation,c=ee(),r=function(e){var t=new Date,a=new Array(7);return a[0]="Sunday",a[1]="Monday",a[2]="Tuesday",a[3]="Wednesday",a[4]="Thursday",a[5]="Friday",a[6]="Saturday",a[t.getDay()]}(Date.now()),i=h(),o=Object(b.a)(i,2),l=o[0],d=(l.messages,l.user),j=l.currentConversation,m=(l.conversations,l.contacts),O=o[1],_=Object(s.useState)(!0),p=Object(b.a)(_,2),f=(p[0],p[1],Object(s.useState)(!1)),g=Object(b.a)(f,2),x=(g[0],g[1]),C=Object(s.useState)(null===(t=a.messages[a.messages.length-1])||void 0===t?void 0:t.message),S=Object(b.a)(C,2),w=S[0],E=S[1],y=function(){var e,t="",n=Object(u.a)(a.chatters);try{for(n.s();!(e=n.n()).done;){var s=e.value;s!==d.email&&(t=s)}}catch(l){n.e(l)}finally{n.f()}var c,r={},i=Object(u.a)(m);try{for(i.s();!(c=i.n()).done;){var o=c.value;o.email===t&&(r.firstname=o.firstname,r.lastname=o.lastname,r.email=o.email)}}catch(l){i.e(l)}finally{i.f()}return r},T=Object(s.useState)(y().firstname),I=Object(b.a)(T,2),R=I[0],L=(I[1],Object(s.useState)(y().lastname)),k=Object(b.a)(L,2),A=k[0],D=(k[1],Object(s.useState)(y().email)),B=Object(b.a)(D,2);return B[0],B[1],Object(s.useEffect)((function(){v()(a.messages)?E("Hey ! I am using What's App Clone"):E(a.messages[a.messages.length-1].message)}),[a]),Object(s.useEffect)((function(){String(a.__id)===String(j.__id)?x(!0):x(!1)}),[j]),Object(n.jsxs)("div",{className:"sidebarConversation",onClick:function(e){return function(e){e.preventDefault(),O({type:"SET_CURRENT_CONVERSATION",currentConv:a})}(e)},children:[Object(n.jsx)("div",{className:"sidebarConversation-avatar",children:Object(n.jsx)(N.a,{className:c.avatar,width:"40px",height:"40px",children:null===R||void 0===R?void 0:R.charAt(0)})}),Object(n.jsxs)("div",{className:"sidebarConversation-content",children:[Object(n.jsxs)("div",{className:"sidebarConversation-title",children:[Object(n.jsxs)("label",{className:"sidebarConversation-name",children:[R," ",A]}),Object(n.jsx)("label",{className:"sidebarConversation-date",children:r})]}),Object(n.jsx)("div",{className:"sidebarConversation-conversation",children:Object(n.jsx)("label",{className:"sidebarConversation-conv",children:w})}),Object(n.jsx)($.a,{light:!0,variant:"fullWidth"})]})]})},ae=Object(g.a)((function(e){return{avatar:{backgroundColor:C.a[300]},inputInput:{backgroundColor:"rgba(255,255,255,0.5)",borderRadius:"20px",width:"80%",color:"rgb(150,150,150)"},searchIcon:{fontSize:20},addIcon:{fontSize:30},margin:{margin:5}}}));var ne=function(){var e=ae(),t=h(),a=Object(b.a)(t,2),c=a[0],r=c.user,i=(c.contacts,c.conversations),o=a[1];return Object(s.useEffect)((function(){}),[i]),Object(n.jsxs)("div",{className:K.a.sidebar__mainContent,children:[Object(n.jsxs)("div",{className:K.a.sidebar__navbar,children:[Object(n.jsxs)("div",{className:K.a.sidebar__left,children:[Object(n.jsx)(N.a,{className:"".concat(e.avatar," ").concat(e.margin),children:null===r||void 0===r?void 0:r.firstname.slice(0,1)}),Object(n.jsx)("p",{className:"".concat(K.a.sidebar__username," ").concat(e.margin),children:null===r||void 0===r?void 0:r.firstname})]}),Object(n.jsxs)("div",{className:K.a.sidebar__right,children:[Object(n.jsx)(x.a,{children:Object(n.jsx)(Q.a,{})}),Object(n.jsx)(x.a,{onClick:function(e){return o({type:"SET_SIDEBAR_SECTION",sideSection:"new-conversation"})},children:Object(n.jsx)(X.a,{className:e.addIcon})}),Object(n.jsx)(x.a,{children:Object(n.jsx)(Z.a,{})})]})]}),Object(n.jsx)("div",{className:K.a.sidebar__searchbar,children:Object(n.jsxs)("div",{className:K.a.sidebar__search,children:[Object(n.jsx)("div",{className:K.a.sidebar__searchIcon,children:Object(n.jsx)(w.a,{className:e.searchIcon})}),Object(n.jsx)(D.a,{placeholder:"Search or start a new chat",className:e.inputInput,inputProps:{"aria-label":"search"}})]})}),Object(n.jsx)("div",{className:K.a.sidebar__listContainer,children:i.map((function(e){return Object(n.jsx)(te,{conversation:e},Object(q.a)())}))})]})},se=a(112),ce=a(42),re=a.n(ce),ie=a(114),oe=a.n(ie),le=a(113),ue=a.n(le),de=Object(g.a)((function(e){return{avatar:{height:40,width:40,marginRight:10,backgroundColor:C.a[600]}}}));var be=function(e){var t=e.contact,a=de(),s=h(),c=Object(b.a)(s,2),r=c[0],i=r.user,o=(r.currentConversation,c[1]),u=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("conversations/new-chat",{chatters:[i.email,t.email]}).then((function(e){console.log(e),console.log("Created new chat between"+e.data.chatters[0]+" and"+e.data.chatters[1]+" : activated => "+e.data.activated),o({type:"SET_CURRENT_CONVERSATION",currentConv:e.data}),o({type:"ADD_CONVERSATION",conversation:e.data}),o({type:"SET_SIDEBAR_SECTION",sideSection:"conversations"})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(n.jsxs)("div",{children:[Object(n.jsxs)("div",{className:ue.a.newContact,onClick:function(e){return u()},children:[Object(n.jsx)(N.a,{className:a.avatar,children:t.firstname[0]}),Object(n.jsxs)("label",{children:[t.firstname," ",t.lastname]})]}),Object(n.jsx)($.a,{light:!0,variant:"fullWidth"})]})},je=Object(g.a)((function(e){return{newGroupButton:{borderRadius:"50%",backgroundColor:"#007868",color:"white",width:30,height:30,padding:10,marginRight:10}}}));var me=function(){var e=je(),t=h(),a=Object(b.a)(t,2),s=a[0],c=(s.sideSection,s.contacts),r=a[1];return Object(n.jsxs)("div",{className:re.a.newContactList,children:[Object(n.jsxs)("div",{className:re.a.newContactList__item,onClick:function(e){return r({type:"SET_SIDEBAR_SECTION",sideSection:"new_group"})},children:[Object(n.jsx)(oe.a,{className:e.newGroupButton}),Object(n.jsx)("label",{className:re.a.newContactList__title,children:"NEW GROUP"})]}),Object(n.jsx)($.a,{light:!0,variant:"fullWidth"}),Object(n.jsxs)("div",{className:re.a.newContactList__listContacts,children:[Object(n.jsx)("div",{className:"".concat(re.a.title),children:Object(n.jsx)("label",{className:re.a.newContactList__title2,children:"FREQUENTLY CONTACTED"})}),Object(n.jsx)($.a,{light:!0,variant:"fullWidth"}),c.map((function(e){return Object(n.jsx)(be,{contact:e},Object(q.a)())}))]})]})},he=a(37),Oe=a.n(he),ve=a(66),_e=a.n(ve),pe=Object(g.a)({backButton:{color:"white",fontSize:35},marginButton:{marginRight:10}});var fe=function(){var e=pe(),t=h(),a=Object(b.a)(t,2);Object(se.a)(a[0]);var s=a[1];return Object(n.jsxs)("div",{className:Oe.a.sidebar__mainContent,children:[Object(n.jsxs)("div",{className:Oe.a.sidebar__navbar,children:[Object(n.jsx)(x.a,{className:e.marginButton,onClick:function(e){return s({type:"SET_SIDEBAR_SECTION",sideSection:"conversations"})},children:Object(n.jsx)(_e.a,{className:e.backButton})}),Object(n.jsx)("p",{className:Oe.a.sidebar__title,children:"New Chat"})]}),Object(n.jsx)("div",{className:Oe.a.sidebar__searchbar,children:Object(n.jsxs)("div",{className:Oe.a.sidebar__search,children:[Object(n.jsx)("div",{className:Oe.a.sidebar__searchIcon,children:Object(n.jsx)(w.a,{className:e.searchIcon})}),Object(n.jsx)(D.a,{placeholder:"Search or start a new chat",className:e.inputInput,inputProps:{"aria-label":"search"}})]})}),Object(n.jsx)("div",{className:Oe.a.sidebar__listContainer,children:Object(n.jsx)(me,{})})]})};a(160);var ge=function(){var e=h(),t=Object(b.a)(e,2),a=t[0],c=(a.user,a.conversations,a.sideSection),r=(a.currentConversation,t[1],Object(s.useState)(c)),i=Object(b.a)(r,2),o=i[0],l=i[1];return Object(s.useEffect)((function(){console.log("sideSection >>>",c),l(c)}),[c]),Object(n.jsxs)("div",{className:"sidebar",children:["conversations"===o?Object(n.jsx)(ne,{}):"","new-conversation"===o?Object(n.jsx)(fe,{}):""]})},xe=(a(161),a(276)),Ne=a(274),Ce=a(67),Se=a.n(Ce),we=a(30),Ee=a.n(we),ye=function(e,t){var a=e.firstname,n=void 0===a?"":a,s=e.lastname,c=void 0===s?"":s,r=e.email,i=e.password,o=e.password2,l=void 0===o?"":o,u=[];switch(t){case"login":Ee.a.isEmpty(r)?u.push("Username is required"):Ee.a.isEmail(r)||u.push("Error format email"),Ee.a.isEmpty(i)&&u.push("Password is required");break;case"register":u.push(Ee.a.isEmpty(n)?"First name is required":""),u.push(Ee.a.isEmpty(c)?"Last name is required":""),Ee.a.isEmpty(r)?u.push("email is required"):Ee.a.isusername(r)||u.push("Error format email"),u.push(Ee.a.isEmpty(i)?"Password is required":""),u.push(Ee.a.isEmpty(l)?"Password2 is required":"")}return{errors:u,isValid:v()(u)}},Te=Object(g.a)((function(e){return{logo:{width:40,height:40},textField:{width:"80%"},margin:{marginBottom:20},button:{width:"80%"}}}));var Ie=function(){var e=h(),t=Object(b.a)(e,2),a=(t[0].user,t[1]),c=Te(),r=Object(s.useState)(""),i=Object(b.a)(r,2),o=i[0],u=i[1],j=Object(s.useState)(""),m=Object(b.a)(j,2),O=m[0],v=m[1],_=Object(s.useState)([]),g=Object(b.a)(_,2),N=g[0],C=g[1],S=Object(f.f)(),w=function(e,t,n){a({type:"SET_USER",user:{firstname:e,lastname:t,email:n,userId:"random_value"}})},E=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,n,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C([]),a=ye({email:o,password:O},"login"),n=a.errors,!a.isValid){e.next=12;break}return s={email:o,password:O},console.log("Connection attempt from ".concat(s.email," >>>")),console.log(s),e.next=9,p.post("/users/login",s).then((function(e){console.log("Login successful >> ",e.data.data.email),w(e.data.data.firstname,e.data.data.lastname,e.data.data.email),S.push("/whatsapp-clone/loading")})).catch((function(e){console.log(e.response),C([e.response.data]),v(""),u("")}));case 9:e.sent,e.next=14;break;case 12:console.log(">>> Error Sign In : check credentials"),C(n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)("form",{children:Object(n.jsxs)("div",{className:"login",children:[Object(n.jsx)(x.a,{children:Object(n.jsx)(Se.a,{className:c.logo})}),Object(n.jsx)("p",{children:" Sign In "}),Object(n.jsx)("ul",{children:N.map((function(e){return Object(n.jsx)("li",{className:"errorMessage",children:e},Object(q.a)())}))}),Object(n.jsx)(xe.a,{className:"".concat(c.textField," ").concat(c.margin),label:"email",variant:"outlined",value:o,type:"email",onChange:function(e){return u(e.target.value)}}),Object(n.jsx)(xe.a,{className:"".concat(c.textField," ").concat(c.margin),label:"password",variant:"outlined",value:O,type:"password",onChange:function(e){return v(e.target.value)}}),Object(n.jsx)(Ne.a,{className:"".concat(c.button," ").concat(c.margin),color:"primary",variant:"contained",type:"submit",onClick:function(e){return E(e)},children:"Sign In"}),Object(n.jsx)("p",{className:c.margin,children:" Or "}),Object(n.jsx)(Ne.a,{className:"".concat(c.button," ").concat(c.margin),href:"/whatsapp-clone/new-account",variant:"contained",type:"submit",children:"Create new account"})]})})},Re=a(33),Le=(a(237),Object(g.a)((function(e){return{logo:{width:40,height:40},logo2:{width:18,height:18},logoPositionLeft:{alignSelf:"start"},textField:{width:"80%"},margin:{marginBottom:20},button:{width:"80%"}}})));var ke=function(){var e=Le(),t=Object(s.useState)(""),a=Object(b.a)(t,2),c=a[0],r=a[1],i=Object(s.useState)(""),o=Object(b.a)(i,2),u=o[0],j=o[1],m=Object(s.useState)(""),O=Object(b.a)(m,2),v=O[0],_=O[1],g=Object(s.useState)(""),N=Object(b.a)(g,2),C=N[0],S=N[1],w=Object(s.useState)(""),E=Object(b.a)(w,2),T=E[0],I=E[1],R=h(),L=Object(b.a)(R,2),k=(L[0].user,L[1]),A=[],D=Object(f.f)(),B=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),a={firstname:c,lastname:u,email:v,password:C,password2:T},p.post("/users/register",a).then((function(e){e&&(console.log("New user registered >>> "),console.log(e.data),k({type:"SET_USER",user:{firstname:e.data.firstname,lastname:e.data.lastname,email:e.data.email,userId:"random_value"}}),D.push("/whatsapp-clone/conversations"))})).catch((function(e){for(var t in console.log("Error registering user"),console.log(e.response.data),e.errors)A.push([e.errors[t]]);console.log(A)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(n.jsx)("form",{children:Object(n.jsxs)("div",{className:"register",children:[Object(n.jsx)(Re.b,{to:"/whatsapp-clone/login",className:e.logoPositionLeft,children:Object(n.jsx)(x.a,{children:Object(n.jsx)(_e.a,{className:e.logo2})})}),Object(n.jsx)(Re.b,{to:"/whatsapp-clone/login",children:Object(n.jsx)(x.a,{children:Object(n.jsx)(Se.a,{className:e.logo})})}),Object(n.jsx)("p",{children:" New Account "}),Object(n.jsx)("ul",{children:A.map((function(e){return Object(n.jsx)("li",{children:e})}))}),Object(n.jsx)(xe.a,{className:"".concat(e.textField," ").concat(e.margin),label:"First name",variant:"outlined",value:c,onChange:function(e){return r(e.target.value)}}),Object(n.jsx)(xe.a,{className:"".concat(e.textField," ").concat(e.margin),label:"Last name",variant:"outlined",value:u,onChange:function(e){return j(e.target.value)}}),Object(n.jsx)(y.a,{className:e.margin}),Object(n.jsx)(xe.a,{className:"".concat(e.textField," ").concat(e.margin),label:"Email address",variant:"outlined",type:"email",value:v,onChange:function(e){return _(e.target.value)}}),Object(n.jsx)(xe.a,{className:"".concat(e.textField," ").concat(e.margin),label:"Password",variant:"outlined",type:"password",value:C,onChange:function(e){return S(e.target.value)}}),Object(n.jsx)(xe.a,{className:"".concat(e.textField," ").concat(e.margin),label:"Confirm password",variant:"outlined",type:"password",value:T,onChange:function(e){return I(e.target.value)}}),Object(n.jsx)(Ne.a,{className:"".concat(e.button," ").concat(e.margin),color:"primary",variant:"contained",type:"submit",onClick:function(e){return B(e)},children:"Sign Up"})]})})},Ae=(a(238),a(275));var De=function(){var e=Object(f.f)();return Object(s.useEffect)((function(){return setTimeout((function(){e.push("/whatsapp-clone/conversations")}),3e3),function(){}}),[]),Object(n.jsx)("div",{children:Object(n.jsx)(Ae.a,{})})},Be=a(115),Fe=a.n(Be);var Pe=function(){var e=h(),t=Object(b.a)(e,2),a=t[0],c=a.user,r=a.currentConversation,i=a.conversations,o=t[1],j=Object(f.f)(),m=Object(f.g)();return Object(s.useEffect)((function(){c?(function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/users/sync").then((function(e){var t,a=[],n=Object(u.a)(e.data);try{for(n.s();!(t=n.n()).done;){var s=t.value;s.email!==c.email&&a.push(s)}}catch(r){n.e(r)}finally{n.f()}o({type:"SET_CONTACTS",contacts:a})}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.post("/conversations/sync",c).then((function(e){e.data&&(console.log("again"),console.log(e.data),o({type:"SET_CONVERSATIONS_LIST",convs:e.data}),v()(r)&&o({type:"SET_CURRENT_CONVERSATION",currentConv:e.data[0]}))}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()):"/whatsapp-clone/new-account"!==m.pathname&&j.replace("/whatsapp-clone/login")}),[c]),Object(s.useEffect)((function(){var e=new Fe.a("3678c5b88461dcff7cb9",{cluster:"eu"}).subscribe("messages");return e.bind("updated",(function(e){console.log(e),o({type:"ADD_NEW_MESSAGE",data:e})})),function(){e.unbind_all(),e.unsubscribe()}}),[i]),Object(n.jsx)("div",{className:"app",children:Object(n.jsxs)(f.c,{children:[Object(n.jsx)(f.a,{path:"/whatsapp-clone/login",children:Object(n.jsx)(Ie,{})}),Object(n.jsx)(f.a,{path:"/whatsapp-clone/new-account",children:Object(n.jsx)(ke,{})}),Object(n.jsx)(f.a,{path:"/whatsapp-clone/conversations",children:Object(n.jsxs)("div",{className:"app-body",children:[Object(n.jsx)(ge,{}),Object(n.jsx)(z,{})]})}),Object(n.jsx)(f.a,{path:"/whatsapp-clone/loading",children:Object(n.jsx)(De,{})}),Object(n.jsx)(f.a,{path:"/",children:Object(n.jsx)(Ie,{})})]})})},We=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,281)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,c=t.getLCP,r=t.getTTFB;a(e),n(e),s(e),c(e),r(e)}))},Ue=a(116),Ve=a(19),qe=function(e,t){switch(t.type){case"SET_USER":return Object(Ve.a)(Object(Ve.a)({},e),{},{user:t.user});case"SET_SIDEBAR_SECTION":return Object(Ve.a)(Object(Ve.a)({},e),{},{sideSection:t.sideSection});case"SET_CONTACTS":return Object(Ve.a)(Object(Ve.a)({},e),{},{contacts:t.contacts});case"SET_CURRENT_CONVERSATION":return Object(Ve.a)(Object(Ve.a)({},e),{},{currentConversation:t.currentConv});case"ADD_CONVERSATION":return Object(Ve.a)(Object(Ve.a)({},e),{},{conversations:[].concat(Object(Ue.a)(e.conversations),[t.conversation])});case"SET_CONVERSATIONS_LIST":return Object(Ve.a)(Object(Ve.a)({},e),{},{conversations:t.convs});case"ADD_NEW_MESSAGE":for(var a=0;a<e.conversations.length;a++)if(String(t.data.conversationId)===String(e.conversations[a]._id))return console.log("id 1 = "+String(t.data.conversationId)),console.log("id 2 = "+String(e.conversations[a]._id)),e.conversations[a].messages.push(t.data.message),console.log(e.conversations[a]),Object(Ve.a)({},e)}};i.a.render(Object(n.jsx)(c.a.StrictMode,{children:Object(n.jsx)(m,{initialState:{user:null,conversations:[],sideSection:"conversations",contacts:[],currentConversation:{}},reducer:qe,children:Object(n.jsx)(Re.a,{children:Object(n.jsx)(Pe,{})})})}),document.getElementById("root")),We()},28:function(e,t,a){e.exports={sidebar__mainContent:"SidebarConversationSection_sidebar__mainContent__3f0Iq",sidebar__left:"SidebarConversationSection_sidebar__left__3dOap",sidebar__username:"SidebarConversationSection_sidebar__username__2F3mX",sidebar__navbar:"SidebarConversationSection_sidebar__navbar__33nIS",sidebar__searchbar:"SidebarConversationSection_sidebar__searchbar__1sVga",sidebar__search:"SidebarConversationSection_sidebar__search__2jN3M",sidebar__searchIcon:"SidebarConversationSection_sidebar__searchIcon__1R45K",sidebar__listContainer:"SidebarConversationSection_sidebar__listContainer__3sT8Z"}},37:function(e,t,a){e.exports={sidebar__mainContent:"SidebarNewConversationSection_sidebar__mainContent__3mEAg",sidebar__navbar:"SidebarNewConversationSection_sidebar__navbar__2wNiE",sidebar__title:"SidebarNewConversationSection_sidebar__title__1KWah",sidebar__searchbar:"SidebarNewConversationSection_sidebar__searchbar__1KkWR",sidebar__search:"SidebarNewConversationSection_sidebar__search__3jizx",sidebar__searchIcon:"SidebarNewConversationSection_sidebar__searchIcon__13MQR",sidebar__listContainer:"SidebarNewConversationSection_sidebar__listContainer__2QnyX"}},42:function(e,t,a){e.exports={newContactList:"NewContactList_newContactList__3l80y",newContactList__listContacts:"NewContactList_newContactList__listContacts__2qxLH",newContactList__item:"NewContactList_newContactList__item__3i2SW",title:"NewContactList_title__2KKn7",newContactList__title:"NewContactList_newContactList__title__1sqNT",newContactList__title2:"NewContactList_newContactList__title2__3b1BJ"}},79:function(e,t,a){}},[[239,1,2]]]);
//# sourceMappingURL=main.04eadb0b.chunk.js.map